"""
This module contains all the query which are used in the database module .
all this query constructed dynamically based on the paramaters configured in default config file
"""
from selfcuremodel.entity.parser.config import  Config
from selfcuremodel.query_formatter.query_formatter import  Query
from selfcuremodel.database.database import  Database
from selfcuremodel.common_utility.common_utility import  CommonUtil
class HtmlUtility:    
    def get_email_html_header():
        """
        Send custom email alerts when job success
        """
        email_html_header = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/></head><body style=\"margin: 0; padding: 0;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tr><td style=\"padding: 10px 0 30px 0;\"><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\" style=\"border: 1px solid #cccccc; border-collapse: collapse;\"><tr><td align=\"center\" bgcolor=\"#70bbd9\" style=\"padding: 10px 0 10px 0; color: #153643; font-size: 28px; font-weight: bold; font-family: Arial, sans-serif;\">"
        return email_html_header
    def get_generic_content_box_with_data(execution_date,try_number,max_tries,hostname,job_id,log_url, task_Owner, trigger_type):
        """
        Send custom email alerts when job success
        """
        inforow = "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border: 1px solid black;margin:0px;font-weight: 750;\">Application Name</td><td width=\"50%\" style=\"padding: 10px;text-align: center;margin:0px;border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;\">Predictive Model</td></tr>"
        inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Execution Date & Time</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+str(execution_date)+"</td></tr>"
        inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Job Stage</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+str(job_id)+"</td></tr>"
        inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">No Of Retry </td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+str(try_number)+" Of "+str((max_tries+1))+"</td></tr>"
        #inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Log URL</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\"><a href=\""+str(log_url)+"\">Click Here</a></td></tr>"
        inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Task Owner</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+task_Owner+" ("+trigger_type+" )</td></tr>"
        inforow = inforow + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-left: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Server</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+str(hostname)+"</td></tr>"
        return inforow
    def get_email_html_header_img_for_training(job_type):
        if job_type == "Success":
            return "<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMzY3LjgwNSAzNjcuODA1IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzNjcuODA1IDM2Ny44MDU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiMzQkI1NEE7IiBkPSJNMTgzLjkwMywwLjAwMWMxMDEuNTY2LDAsMTgzLjkwMiw4Mi4zMzYsMTgzLjkwMiwxODMuOTAycy04Mi4zMzYsMTgzLjkwMi0xODMuOTAyLDE4My45MDINCgkJUzAuMDAxLDI4NS40NjksMC4wMDEsMTgzLjkwM2wwLDBDLTAuMjg4LDgyLjYyNSw4MS41NzksMC4yOSwxODIuODU2LDAuMDAxQzE4My4yMDUsMCwxODMuNTU0LDAsMTgzLjkwMywwLjAwMXoiLz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRDRFMUY0OyIgcG9pbnRzPSIyODUuNzgsMTMzLjIyNSAxNTUuMTY4LDI2My44MzcgODIuMDI1LDE5MS4yMTcgMTExLjgwNSwxNjEuOTYgMTU1LjE2OCwyMDQuODAxIA0KCQkyNTYuMDAxLDEwMy45NjggCSIvPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=\" alt=\"\" width=\"300\" height=\"230\" style=\"display: block;\" /><h5 style=\"margin:10px;color:g;\"> Training Job Success !!</h5>"
        if job_type == "Failure":
            return "<img src=\"data:image/png;base64,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\" alt=\"Creating Email Magic\" width=\"300\" height=\"230\" style=\"display: block;\" /><h5 style=\"margin:10px;color:red;\"> Training Job Failled !!</h5>"
    def get_email_html_header_img_for_scoring(job_type):
        if job_type == "Success":
            return "<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMzY3LjgwNSAzNjcuODA1IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzNjcuODA1IDM2Ny44MDU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiMzQkI1NEE7IiBkPSJNMTgzLjkwMywwLjAwMWMxMDEuNTY2LDAsMTgzLjkwMiw4Mi4zMzYsMTgzLjkwMiwxODMuOTAycy04Mi4zMzYsMTgzLjkwMi0xODMuOTAyLDE4My45MDINCgkJUzAuMDAxLDI4NS40NjksMC4wMDEsMTgzLjkwM2wwLDBDLTAuMjg4LDgyLjYyNSw4MS41NzksMC4yOSwxODIuODU2LDAuMDAxQzE4My4yMDUsMCwxODMuNTU0LDAsMTgzLjkwMywwLjAwMXoiLz4NCgk8cG9seWdvbiBzdHlsZT0iZmlsbDojRDRFMUY0OyIgcG9pbnRzPSIyODUuNzgsMTMzLjIyNSAxNTUuMTY4LDI2My44MzcgODIuMDI1LDE5MS4yMTcgMTExLjgwNSwxNjEuOTYgMTU1LjE2OCwyMDQuODAxIA0KCQkyNTYuMDAxLDEwMy45NjggCSIvPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=\" alt=\"\" width=\"300\" height=\"230\" style=\"display: block;\" /><h5 style=\"margin:10px;color:g;\"> Scoring Job Success !!</h5>"
        if job_type == "Failure":
            return "<img src=\"data:image/png;base64,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\" alt=\"\" width=\"300\" height=\"230\" style=\"display: block;\" /><h5 style=\"margin:10px;color:red;\"> Scoring Job Failled !!</h5>"
    def get_email_html_footer_content():
        return "</tr></table></td></tr></table></td></tr><tr><td bgcolor=\"#ee4c50\" style=\"padding: 30px 30px 30px 30px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tr><td style=\"color: #ffffff; font-family: Arial, sans-serif; font-size: 14px;text-align:center\" width=\"100%\">*** This is an automatically generated email.Hence further reply is not required ***</td></tr></table></td></tr></table></td></tr></table></body></html>"
    def get_email_html_msg_content(job_type):
        if job_type == "Success":
            return "</td></tr><tr><td bgcolor=\"#ffffff\" style=\"padding: 40px 30px 40px 30px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tr><td style=\"color: #153643; font-family: Arial, sans-serif; font-size: 24px;fond-weight:bolder\"><b>Dear Team,</b></td></tr><tr><td style=\"padding: 20px 0 30px 0; color: #153643; font-family: Arial, sans-serif; font-size: 14px; line-height: 20px;fond-weight:bold;\">This is to inform you that the predictive model batch job ran successfully.You can also further investigate on the job run status.<br></br>Please find below table for the job ran details for your refference to further investigate.</td></tr><tr><td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"text-align: center;border-bottom:1px solid black;\">"
        if job_type == "Failure":
            return "</td></tr><tr><td bgcolor=\"#ffffff\" style=\"padding: 40px 30px 40px 30px;\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tr><td style=\"color: #153643; font-family: Arial, sans-serif; font-size: 24px;fond-weight:bolder\"><b>Dear Team,</b></td></tr><tr><td style=\"padding: 20px 0 30px 0; color: #153643; font-family: Arial, sans-serif; font-size: 14px; line-height: 20px;fond-weight:bold;\">This is to inform you that the predictive model batch job had been  failed.Hence requesting kind attention to further investicate and rectify the issue as early as possible.<br></br> Please find below table for the  job ran details for your refference to further investigate.</td></tr><tr><td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"text-align: center;border-bottom:1px solid black;\">"
    def get_success_email_summary_box_for_training():
        success_email_data_content_box_for_training = ""
        try:
            default_config = Config()
            query = Query(default_config)
            database = Database(default_config)
            common_util = CommonUtil(default_config)
            last_model_name = common_util.load_last_model_name('_SC_LR')
            training_data_count_query = query.get_train_valiate_query()
            training_max_min_dates_query = query.get_training_max_min_dates()
            data_retention_period = default_config.get_retionperiod()
            training_data_count = database.get_training_data_count(training_data_count_query)
            max_date , min_date = database.get_training_max_min_dates_for_email_report(training_max_min_dates_query)
            success_email_data_content_box_for_training = "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border: 1px solid black;margin:0px;font-weight: 750;\">Model Name</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-top:1px solid black;\">"+str(last_model_name)+"_SC_LR.sav</td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-left:1px solid black;border-bottom:1px solid black;margin:0px;font-weight: 750;\">No Of Periods</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-top:1px solid black;margin:0px;\">"+str(int(data_retention_period)*12)+" Month(s)</td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-left:1px solid black;border-bottom:1px solid black;margin:0px;font-weight: 750;\">Volume of Data</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-top:1px solid black;margin:0px;\">"+str(training_data_count)+" </td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-left:1px solid black;border-bottom:1px solid black;margin:0px;font-weight: 750;\">Start Date</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-top:1px solid black;margin:0px;\">"+str(min_date)+"</td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-left:1px solid black;border-bottom:1px solid black;margin:0px;font-weight: 750;\">End Date</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right:1px solid black;border-top:1px solid black;border-bottom:1px solid black;margin:0px;\">"+str(max_date)+"</td></tr>"
            tablepart = "</table></td></tr><tr><td style=\"padding: 20px 0 30px 0; color: #153643; font-family: Arial, sans-serif; font-size: 14px; line-height: 20px;fond-weight:bold;\">You can find summary of data processed in the below table for your refference.</td></tr><tr><td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"text-align: center;\">"
            success_email_data_content_box_for_training = tablepart+ success_email_data_content_box_for_training
        except Exception as err:
            raise Exception('Exception Occured while running featureEngineeringJob : {}'.format(str(err)))
        return success_email_data_content_box_for_training
    def get_success_email_summary_box_for_scoring():
        success_email_data_content_box_for_training = ""
        try:
            default_config = Config()
            query = Query(default_config)
            database = Database(default_config)
            latest_scoring_summary_data_query = query.get_latest_scoring_summary_data_query()
            score_date , p_count,r_count,m_count,n_count,null_count,total_invoice = database.get_latest_scoring_summary_data(latest_scoring_summary_data_query)
            print(score_date)
            success_email_data_content_box_for_training = "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border: 1px solid black;margin:0px;font-weight: 750;\">Invoice Supply Date</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;margin:0px;\">"+str(score_date)+"</td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Processed (P)</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;margin:0px;border-bottom:0px;\">"+str(p_count)+" </td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Skipped Invoice (R)</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;margin:0px;\">"+str(r_count)+" </td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Skipped Invoice (N)</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;;margin:0px;\">"+str(n_count)+" </td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Skipped Invoice (M)</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;margin:0px;\">"+str(m_count)+" </td></tr>"
            success_email_data_content_box_for_training = success_email_data_content_box_for_training + "<tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Non Invoice</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;margin:0px;\">"+str(null_count)+"</td></tr><tr><td width=\"50%\" style=\"padding: 10px;text-align: center;border-right: 1px solid black;border-left: 1px solid black;border-bottom: 1px solid black;margin:0px;font-weight: 750;\">Total Invoice</td><td width=\"50%\" style=\"padding: 10px;text-align: center;border-top: 1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;margin:0px;\">"+str(total_invoice)+"</td></tr>"

            tablepart = "</table></td></tr><tr><td style=\"padding: 20px 0 30px 0; color: #153643; font-family: Arial, sans-serif; font-size: 14px; line-height: 20px;fond-weight:bold;\">You can find summary of data processed in the below table for your refference.</td></tr><tr><td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"text-align: center;\">"
            success_email_data_content_box_for_training = tablepart + success_email_data_content_box_for_training
        except Exception as err:
            raise Exception('Exception Occured while running featureEngineeringJob : {}'.format(str(err)))
        return success_email_data_content_box_for_training
